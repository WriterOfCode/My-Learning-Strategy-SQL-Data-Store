CREATE PROCEDURE [dbo].[DeteUserResponsesNotIn]
	@ResponseIds NVARCHAR(MAX)
AS
	DECLARE @Character CHAR(1);
	SET @Character = ",";
	BEGIN
		BEGIN TRANSACTION RESPONSE;
		BEGIN TRY
			DELETE FROM [dbo].[Responses]
			WHERE ResponseId not in (SELECT Item FROM DBO.SPLITSTRING(@ResponseIds,@Character));
		END TRY
		BEGIN CATCH

		IF @@TRANCOUNT>0
			ROLLBACK TRANSACTION RESPONSE;
		END CATCH;
		IF @@TRANCOUNT>0
			COMMIT TRANSACTION RESPONSE;
	END
RETURN 0